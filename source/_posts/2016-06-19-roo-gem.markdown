---
layout: post
title: "使用 roo gem 來讀取 Excel and"
date: 2016-06-19 22:24:45 +0800
comments: true
categories: gem
---

## 什麼是 roo

用來方便讀取 xls, xlsx, csv 的檔案內容，最常用在匯入一些excel的資料
這邊會先介紹簡單的roo 使用，會在下一個剖份再來實作一個 web 上傳檔案可以匯入的功能


## 如何使用


 ```
  gem install roo
 ```

 另外如果有編碼的問題，請也一併用 iconv 來處理

## 範例

簡單的說明一下，假設我有一份 xlsx 的檔案，如下圖

![Alt text](/images/roo/xlsx_file.png)


接下來使用 roo 來簡單的讀取資料
這邊我寫一支簡單的ruby 來測試一下，所以當我執行 `` Excel.import("../hotels.xlsx") `` 就可以把我要的xlsx試著print出來


```
require 'roo'
require 'iconv'


class Hotel
  def initialize(name, address, coordinates)
    @name = name
    @address = address
    @coordinates = coordinates
  end

  def print
    "#{@name} | #{@address} | #{@coordinates}"
  end
end

class Excel

  def self.import(file_path)
    xlsx = Roo::Spreadsheet.open(file_path)
    xlsx.first_row.upto(xlsx.last_row) do |row|
      name = xlsx.cell(row,'A')
      address = xlsx.cell(row,'B')
      coordinates = xlsx.cell(row,'C')
      puts Hotel.new(name, address, coordinates).print
    end
  end

end

Excel.import("../hotels.xlsx")


```

大功告成，下一篇再來實作一個檔案上傳可以import的功能


## 參考資料
[http://roo.rubyforge.org/](http://roo.rubyforge.org/)
[https://github.com/roo-rb/roo] (https://github.com/roo-rb/roo)
[Railscasts](http://railscasts.com/episodes/396-importing-csv-and-excel?autoplay=true)



